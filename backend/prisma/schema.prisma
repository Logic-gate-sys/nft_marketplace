generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Collection {
  address   String? 
  col_uri   String
  create_at DateTime   @default(now())
  id        Int        @id @default(autoincrement())
  user_id   Int
  User      User       @relation(fields: [user_id], references: [id])
  Listings  Listings[]
  Nft       Nft[]
}

model Listings {
  id            Int        @id @default(autoincrement())
  col_id        Int
  token_id      Int
  base_price    BigInt
  current_price BigInt?
  seller        String
  listed_at     DateTime   @default(now())
  Collection    Collection @relation(fields: [col_id], references: [id])

  @@unique([col_id, token_id])
}


model Nft {
  col_id     Int
  id         Int        @id @unique @default(autoincrement())
  token_id   Int
  owner_id   Int
  uri        String?
  Collection Collection @relation(fields: [col_id], references: [id])
  User       User       @relation(fields: [owner_id], references: [id])
}

model Sold {
  tokenId Int
  from    String
  to      String
  amount  Int
  at      DateTime @default(now())
  id      Int      @id @default(autoincrement())
}

model User {
  username   String?
  wallet     String       @unique
  email      String?
  id         Int          @id @default(autoincrement())
  Collection Collection[]
  Nft        Nft[]
}
